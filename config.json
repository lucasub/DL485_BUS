// File di configurazione DL485
// COMMENTI DEVONO INIZIARE SOLO CON // OPPURE con  #

#   Tipo di dispositivi disponibili su Domoticz
// "Air Quality"
// "Alert"
// "Barometer"
// "Counter Incremental"
// "Current/Ampere"
// "Current (Single)"
// "Custom"
// "Distance"
// "Gas"
// "Humidity"
// "Illumination"
// "kWh"
// "Leaf Wetness"
// "Percentage"
// "Pressure"
// "Rain"
// "Selector Switch"
// "Soil Moisture"
// "Solar Radiation"
// "Sound Level"
// "Switch"
// "Temperature"
// "Temp+Hum"
// "Temp+Hum+Baro"
// "Text"
// "Usage"
// "UV"
// "Visibility"
// "Voltage"
// "Waterflow"
// "Wind"
// "Wind+Temp+Chill"

# Descrizione PLC
# All'interno delle singole board è presente un PLC che può essere attivato tramite la funzione desiderata (es. toggle_on)

#    plc_function:       => Funzione associata al PLC relativa a quell'uscita
#       disable         => PLC disabilitato
#       equal           => funzione uguale. Ad esempio uscita = ingresso
#       and             => funzione AND
#       or              => funzione OR
#       xor             => funzione XOR
#       odd             => funzione dispari. Uscita a 1 se gli ingressi a 1 sono dispari
#       toggle_on       => fa il toggle sul fronte ON dell'ingresso
#       toggle_off      => fa il toggle sul fronte OFF dell'ingresso
#       toggle_on_off   => fa il toggle sul fronte OFF e ON dell'ingresso
#       timer           => timer uscita
#       power_on        => Uscita per comandare il rele di reset alimentazione RAPBERRY quando non risponde sulla seriale per un certo tempo.

#    inverted            => uscita negata
#        0               => non invertita
#        1               => invertita
#




{ //inizio file
    # Tipi di Board disponibili. Non toccare
    "TYPEB": {
        "DL485M": 1,
        "DL485B": 2,
        "DL485Pold": 3, //scheda tipo 3 vecchia sostituita con 5
        "DL485R": 4,
        "DL485P": 5,
        "1": "DL485M",
        "2": "DL485B",
        "3": "DL485Pold",
        "4": "DL485R",
        "5": "DL485P"
    },

    # Configurazione generale del BUS
    "GENERAL_NET": {
        "bus_port": "/dev/ttyAMA0", # Porta seriale Raspberry PI
        "bus_baudrate": 19200, // Velocità BUS e seriale
        "max_board_address": 24, // Numero massimo di Board presenti sul BUS
        "board_address": 2 // ID assegnato a Raspberry. Deve avere l'ID della scheda collegata alla seriale di Raspberry PI +1
    },
    "BOARD4": {
        "GENERAL_BOARD": {
            "name": "SCHEDA RELE", // Nome della BOARD
            "board_type": 4, // Tipo di Board: Vedi TYPEB
            "enable": 1 // Abilitazione della BOARD: 0=disabilitata, 1=abilitata
        },
        //         Tensione alimentazione BOARD
        "VIN": { // Tensione alimentazione BOARD
            "enable": 1, // Valori: 0 disabilitato, 1 abilitato. Abilitazione dell'IO
            "logic_io": 1, // Valori interi. IO LOGICO che deve essere UNIVOCO per ciascun IO della stessa BOARD
            "time_refresh": 60, // Valori: 0...16382 decimi di secondo, 16384 MAI. Tempo di ritrasmissione del valore dell'IO sul BUS. 600 = 60 secondi
            "device_type": "VINR1R2",
            "rvcc": 12000, // Valore resistenza posta tra IO e ingresso alimentazione.
            "rgnd": 470, // Valore resistenza posta tra IO e 0V.
            "name": "Vin", // Nome che verrà riportato su DOMOTICZ
            "description": "Tensione alimentazione scheda" // Descrizione che verrà riportato su DOMOTICZ
        },
        "TEMP_ATMEGA": {
            "enable": 1,
            "logic_io": 2,
            "time_refresh": 60,
            "device_type": "TEMP_ATMEGA",
            "name": "TEMP_ATMEGA",
            "description": "Temperatura Board ATMEGA328PB"
        },
        "IO3": {
            "enable": 1,
            "logic_io": 3,
            "device_type": "DIGITAL_IN_PULLUP",
            "default_startup_filter_value": 0,
            "time_refresh": 600,
            "filter": 20,
            "inverted": 0,
            "name": "pulsante1",
            "description": "pulsante1"
        },
        "IO4": {
            "enable": 1, // I/O enable
            "logic_io": 4, // Logic reference (ID) of each I/O
            "device_type": "DIGITAL_IN_PULLUP",
            "default_startup_filter_value": 0, // Preset filter state
            "time_refresh": 600, // Refresh data into BUS
            "filter": 20,
            "inverted": 0,
            "name": "pulsante2",
            "description": "pulsante2"
        },
        "OUT2": {
            "enable": 1, // I/O enable
            "logic_io": 5, // Logic reference (ID) of each I/O
            "device_type": "DIGITAL_OUT",
            //"default_startup_value": 0,
            //"default_startup_filter_value": 3, // if omitted: default = 0
            "time_refresh": 300, // Time in sec/10, if omitted: default = 3000 (300 seconds)
            "filter": 20, // if omitted: default = 20
            "plc_preset_input": 0, // Preset data byte input until arrive communication, if omitted: default = 0
            "plc_function": "toggle_on_off", // PLC function
            "plc_linked_board_id_logic_io": [ // PLC inputs
                "*-3",
                "*-4"
            ],
            "plc_time_unit": 1, // Time unit (1: 1 second - 0.1 - 0.01 - 2.5)
            "plc_tmax_on": 3, // Max time output ON, if omitted: default = 65635 (infinite)
            "name": "OUT RELE",
            "description": "OUT RELE"
        }
    },




    "BOARD1": {
        //         Configurazione generale della BOARD
        "GENERAL_BOARD": {
            "name": "SCHEDA MASTER", // Nome della BOARD
            "board_type": 4, // Tipo di Board: Vedi TYPEB
            "enable": 0 // Abilitazione della BOARD: 0=disabilitata, 1=abilitata
        },
        //         Tensione alimentazione BOARD
        "VIN": { // Tensione alimentazione BOARD
            "enable": 1, // Valori: 0 disabilitato, 1 abilitato. Abilitazione dell'IO
            "logic_io": 1, // Valori interi. IO LOGICO che deve essere UNIVOCO per ciascun IO della stessa BOARD
            "time_refresh": 60, // Valori: 0...16382 decimi di secondo, 16384 MAI. Tempo di ritrasmissione del valore dell'IO sul BUS. 600 = 60 secondi
            "device_type": "VINR1R2",
            "rvcc": 12000, // Valore resistenza posta tra IO e ingresso alimentazione.
            "rgnd": 470, // Valore resistenza posta tra IO e 0V.
            "name": "Vin", // Nome che verrà riportato su DOMOTICZ
            "description": "Tensione alimentazione scheda" // Descrizione che verrà riportato su DOMOTICZ
        },
        "TEMP_ATMEGA": {
            "enable": 1,
            "logic_io": 2,
            "time_refresh": 60,
            "device_type": "TEMP_ATMEGA",
            "name": "TEMP_ATMEGA",
            "description": "Temperatura Board ATMEGA328PB"
        },
        "IO3": {
            "enable": 0,
            "logic_io": 3,
            "device_type": "DIGITAL_IN_PULLUP",
            "default_startup_filter_value": 1,
            "time_refresh": 600,
            "n_refresh_on": 1,
            "n_refresh_off": 1,
            "filter": 20,
            "inverted": 1,
            "name": "pulsante",
            "description": "pulsantexxx",
            "dtype": "Switch"
        },
        "OUT1": {
            "enable": 0,
            "logic_io": 4,
            "device_type": "DIGITAL_OUT",
            "default_startup_value": 0,
            "inverted": 0,
            "filter": 127,
            "time_refresh": 16383,
            "plc_function": "power_on",
            "plc_linked_board_id_logic_io": [
                "*-1"
            ],
            "power_on_timeout": 128, //3000: 300 secondi di assenza seriale prima di spegnere
            "power_on_tmin_off": 32, //30: 3 secondi di tempo minimo off rasperry
            "power_on_voltage_off": 11.4, //11.4: soglia tensione bassa, si comanda spegnimento raspberry
            "power_on_voltage_on": 12.8, //12.8: soglia alta, si comanda accensione se raspberry era spento
            "name": "BUS OUT RESET",
            "description": "BUS Uscita RELE RESET RASPBERRY",
            "dtype": "Switch"
        },
        "OUT2": {
            "enable": 0,
            "logic_io": 5,
            "device_type": "DIGITAL_OUT",
            "time_refresh": 60,
            "n_refresh_on": 1,
            "n_refresh_off": 1,
            "default_startup_filter_value": 1,
            "plc_function": "toggle_on",
            "plc_linked_board_id_logic_io": [
                "3-5",
                "*-3"
            ],
            "name": "prova",
            "description": "prova prova",
            "dtype": "Switch"
        }
    }, //fine board
    // Definizione della BOARD con ID n.3. Sul BUS ogni Board deve avere un ID univoco
    "BOARD3": {
        // Configurazione generale della BOARD
        "GENERAL_BOARD": {
            "name": "SCHEDA CONTATORE", // Nome della BOARD
            "board_type": 1, // Tipo di Board: Vedi TYPEB
            "enable": 0 // Abilitazione della BOARD: 0=disabilitata, 1=abilitata
        },
        // Tensione alimentazione BOARD
        "VIN": { // Tensione alimentazione BOARD
            "enable": 1, // Valori: 0 disabilitato, 1 abilitato. Abilitazione dell'IO
            "logic_io": 1, // Valori interi. IO LOGICO che deve essere UNIVOCO per ciascun IO della stessa BOARD
            "time_refresh": 20, // Valori: 0...16382 decimi di secondo, 16384 MAI. Tempo di ritrasmissione del valore dell'IO sul BUS. 600 = 60 secondi
            "device_type": "VINR1R2",
            "rvcc": 12000, // Valore resistenza posta tra IO e ingresso alimentazione.
            "rgnd": 470, // Valore resistenza posta tra IO e 0V.
            "name": "Vin", // Nome che verrà riportato su DOMOTICZ
            "description": "Tensione alimentazione scheda" // Descrizione che verrà riportato su DOMOTICZ
        },
        "TEMP_ATMEGA": {
            "enable": 1,
            "logic_io": 2,
            "time_refresh": 30,
            "device_type": "TEMP_ATMEGA",
            "name": "TEMP_ATMEGA",
            "description": "Temperatura Board ATMEGA328PB"
        },
        "PD3": {
            "enable": 1,
            "logic_io": 3,
            "device_type": "DS18B20",
            "time_refresh": 30,
            "name": "DS18B20",
            "description": "Sensore Temperatura",
            "dtype": "Temperature"
        },
        "PD4": {
            "enable": 1,
            "logic_io": 4,
            "device_type": "DS18B20",
            "time_refresh": 30,
            "name": "DS18B20",
            "description": "Sensore Temperatura",
            "dtype": "Temperature"
        },
        "PC0": {
            "enable": 1,
            "logic_io": 5,
            "device_type": "DIGITAL_IN_PULLUP",
            "default_startup_filter_value": 1,
            "time_refresh": 20,
            "n_refresh_on": 1,
            "n_refresh_off": 1,
            "filter": 20,
            "inverted": 1,
            "name": "pulsante",
            "description": "pulsantexxx",
            "dtype": "Switch"
        }
    }, //fine board
    "BOARD7": { //da provare e duplicare con board 5
        "GENERAL_BOARD": { // Configurazione generale della BOARD
            "enable": 0, // Abilitazione della BOARD: 0=disabilitata, 1=abilitata
            "name": "BUS", // Nome della BOARD
            "board_type": 5 // Tipo di Board: Vedi TYPEB
        },
        "VIN": { // Tensione alimentazione BOARD
            "enable": 1, // Valori: 0 disabilitato, 1 abilitato. Abilitazione dell'IO
            "logic_io": 1, // Valori interi. IO LOGICO che deve essere UNIVOCO per ciascun IO della stessa BOARD
            "time_refresh": 600, // Valori: 0...16382 decimi di secondo, 16384 MAI. Tempo di ritrasmissione del valore dell'IO sul BUS. 600 = 60 secondi
            "device_type": "VINR1R2",
            "rvcc": 12000, // Valore resistenza posta tra IO e ingresso alimentazione.
            "rgnd": 470, // Valore resistenza posta tra IO e 0V.
            "name": "Vin", // Nome che verrà riportato su DOMOTICZ
            "description": "Tensione alimentazione scheda" // Descrizione che verrà riportato su DOMOTICZ
        },
        "TEMP_ATMEGA": {
            "enable": 1,
            "logic_io": 2,
            "time_refresh": 600,
            "device_type": "TEMP_ATMEGA",
            "name": "TEMP_ATMEGA",
            "description": "Temperatura Board ATMEGA328PB"
        },
        "PC0": { //1wire
            "enable": 1,
            "logic_io": 3,
            "time_refresh": 60,
            "device_type": "DS18B20",
            "name": "DS18B20",
            "description": "Sensore Temperatura"
        },
        "PC1": { //1wire
            "enable": 1,
            "logic_io": 4,
            "time_refresh": 60,
            "device_type": "DS18B20",
            "name": "DS18B20",
            "description": "Sensore Temperatura",
            "dtype": "Temperature"
        },
        "PY1": { //uscita di python
            "enable": 0,
            "logic_io": 4,
            "device_type": "PSICROMETER",
            "plc_function": "humidity2t",
            "plc_linked_board_id_logic_io": [
                "*-3",
                "*-4"
            ],
            "description": "Umidita bulbo secco/umido"
        }
    } //fine board
} //fine file
